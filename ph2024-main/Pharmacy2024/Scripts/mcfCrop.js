initContainer = function (e, t = 80, a = 0, n = 0, i = "", c = 500, d) { var h, s, l, r, o, g, u, m, p, v, f = { x: 50, y: 100, w: 200, h: 200 }, w = 0, y = 0, x = 20, E = !1, L = !1, C = !1, I = !1, R = 1, k = !1, H = !1, M = "", b = ""; p = document.createElement("img"), o = a, g = n, u = t, m = d, container = document.getElementById(e); var T = document.createElement("div"); T.id = "idMenu", T.className = "tbl"; var B = document.createElement("div"); B.className = "c20", B.innerHTML = "<img src=" + i + "open.png height=35 width=35 onclick=document.getElementById('myFiles').click()>", T.appendChild(B); var N = document.createElement("div"); N.className = "c20", N.innerHTML = "<img src=" + i + "camera.png height=35 width=35 onclick=document.getElementById('myCam').click()>", T.appendChild(N); var W = document.createElement("div"); W.className = "c20", W.innerHTML = "<img src=" + i + "reload.png height=35 width=35 onclick=reloadImage()>", T.appendChild(W); var D = document.createElement("div"); D.className = "c20", D.innerHTML = "<img src=" + i + "crop.png height=35 width=35 onclick=cropImage()>", T.appendChild(D); var F = document.createElement("div"); F.className = "c20 btnUplodHide", F.innerHTML = "<img src=" + i + "upload.png height=35 width=35 onclick=saveImage(80)>", T.appendChild(F), container.appendChild(T); var O = document.createElement("input"); O.id = "myFiles", O.type = "file", O.style.display = "none", O.accept = "image/*,application/pdf", container.appendChild(O); var U = document.createElement("input"); function A(e) { w = e.pageX - this.offsetLeft, y = e.pageY - this.offsetTop, Y() } function X(e) { e.touches.length > 2 || (w = e.touches[0].clientX - this.offsetLeft, y = e.touches[0].clientY - this.offsetTop, Y(), e.preventDefault()) } function Y() { function e(e, t) { return Math.abs(e - t) < x } e(w, f.x) && e(y, f.y) ? E = !0 : e(w, f.x + f.w) && e(y, f.y) ? C = !0 : e(w, f.x) && e(y, f.y + f.h) ? L = !0 : e(w, f.x + f.w) && e(y, f.y + f.h) && (I = !0) } function _() { E = C = L = I = !1 } function j(e) { w = e.pageX - this.offsetLeft, y = e.pageY - this.offsetTop, P() } function K(e) { w = e.touches[0].clientX - this.offsetLeft, y = e.touches[0].clientY - this.offsetTop, P() } function P() { E ? (f.w += f.x - w, f.h += f.y - y, f.x = w, f.y = y, draw(f.x, f.y, f.w, f.h)) : C ? (f.w = Math.abs(f.x - w), f.h += f.y - y, f.y = y, draw(f.x, f.y, f.w, f.h)) : L ? (f.w += f.x - w, f.h = Math.abs(f.y - y), f.x = w, draw(f.x, f.y, f.w, f.h)) : I && (f.w = Math.abs(f.x - w), f.h = Math.abs(f.y - y), draw(f.x, f.y, f.w, f.h)) } U.id = "myCam", U.type = "file", U.style.display = "none", U.accept = "image/*;capture=camera", U.capture = "", container.appendChild(U), (h = document.createElement("img")).id = "idBaseImage", h.src = "//:0", h.style.display = "none", container.appendChild(h), (l = document.createElement("div")).id = "divBaseCanvas", l.style.width = "100%", l.style.height = "500px", (s = document.createElement("canvas")).id = "idBaseCanvas", s.style = "margin:auto;display:block;", l.appendChild(s), container.appendChild(l), r = s.getContext("2d"), h.onload = function () { !function () { h.naturalHeight < h.naturalWidth ? (R = l.clientWidth / h.naturalWidth, r.canvas.width = l.clientWidth, r.canvas.height = h.naturalHeight * R) : (R = l.clientHeight / h.naturalHeight, r.canvas.width = h.naturalWidth * R, r.canvas.height = l.clientHeight); r.canvas.height, r.canvas.width, r.drawImage(h, 0, 0, r.canvas.width, r.canvas.height) }(), s.addEventListener("mousedown", A, !1), s.addEventListener("mouseup", _, !1), s.addEventListener("mousemove", j, !1), s.addEventListener("touchstart", X, !1), s.addEventListener("touchend", _, !1), s.addEventListener("touchmove", K, !1) }, O.onclick = function (e) { const { target: t = {} } = event || {}; t.value = "" }, O.onchange = function (e) { var t, a = (e.target || window.event.srcElement).files; if (t = O.value, M = t.substr(t.lastIndexOf("\\") + 1).split(".")[0], b = O.value.split(".")[1], FileReader && a && a.length) { var n = new FileReader; n.onload = function () { if (v = n.result, "PDF" == b.toUpperCase()) { H = !0; const e = a[0].size; return Math.round(e / 1024) >= c ? void alert("Please select a file less than " + c + "kb") : void (h.src = i + "pdf.png") } H = !1, h.src = n.result, p.src = n.result }, n.readAsDataURL(a[0]) } }, U.onchange = function (e) { var t, a = (e.target || window.event.srcElement).files; if (t = O.value, M = t.substr(t.lastIndexOf("\\") + 1).split(".")[0], b = O.value.split(".")[1], FileReader && a && a.length) { var n = new FileReader; n.onload = function () { H = !1, h.src = n.result, p.src = n.result }, n.readAsDataURL(a[0]) } }, reloadImage = function () { h.src = v }, draw = function (e, t, a, n) { if (!(h.src.indexOf("//:0") >= 0 || h.src.indexOf("_BLANK_") >= 0 || 1 == H)) { r.clearRect(0, 0, s.width, s.height), r.drawImage(h, 0, 0, r.canvas.width, r.canvas.height); r.lineWidth = 5, r.strokeStyle = "yellow", r.strokeRect(e - 5, t - 5, a + 10, n + 10); s.width, s.height; r.fillStyle = "yellow", r.fillRect(e - 15, t - 15, 20, 20), r.fillRect(e + a - 5, t - 15, 20, 20), r.fillRect(e - 15, t + n - 5, 20, 20), r.fillRect(e + a - 5, t + n - 5, 20, 20) } }, cropImage = function () { if (!(h.src.indexOf("//:0") >= 0 || h.src.indexOf("_BLANK_") >= 0 || 1 == H)) { if (0 == k) return f.x = 50, f.y = 50, f.w = s.width - 100, f.h = s.height - 100, draw(f.x, f.y, f.w, f.h), void (k = !0); f.w >= f.h ? (r.canvas.width = l.clientWidth, r.canvas.height = f.h * l.clientWidth / f.w) : (r.canvas.width = f.w * l.clientHeight / f.h, r.canvas.height = l.clientHeight), r.drawImage(h, f.x / R, f.y / R, f.w / R, f.h / R, 0, 0, s.width, s.height); var e = document.createElement("canvas").getContext("2d"); e.canvas.width = f.w / R, e.canvas.height = f.h / R, e.drawImage(h, f.x / R, f.y / R, f.w / R, f.h / R, 0, 0, e.canvas.width, e.canvas.height), p.src = e.canvas.toDataURL("image/jpeg", u / 100), h.src = r.canvas.toDataURL("image/jpeg"), !0, k = !1 } }, saveImage = function (e) { if (H) "function" == typeof m && m(v, M, b); else { var t = document.createElement("canvas"), a = 0, n = p.width, i = p.height; a = g > 0 && o > 0 ? g > o ? g : o : p.width > p.height ? p.width : p.height, n > i ? n > a && (i *= a / n, n = a) : i > a && (n *= a / i, i = a), t.width = n, t.height = i, t.getContext("2d").drawImage(p, 0, 0, n, i); var c = t.toDataURL("image/jpeg"); "function" == typeof m && m(c, M, b) } } };